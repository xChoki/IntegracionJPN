<!DOCTYPE html>
<html lang="en">

   <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Predicción - Fundamentos de Machine Learning</title>
  
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
  
    </head>

   <body class="">
      <header class="mb-auto">
         <div class="container">
           <nav class="navbar navbar-expand-lg navbar-light">
             <div class="container-fluid">
               <a class="navbar-brand" href="/">Modelo predictivo</a>
               <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                 <span class="navbar-toggler-icon"></span>
               </button>
               <div class="collapse navbar-collapse" id="navbarNav">
                 <ul class="navbar-nav">
                   <li class="nav-item">
                     <a class="nav-link" aria-current="page" href="/">Principal</a>
                   </li>
                   <li class="nav-item">
                     <a class="nav-link" href="https://github.com/xChoki/IntegracionJPN" target="_blank">GitHub</a>
                   </li>
                   <li class="nav-item">
                     <a class="nav-link" href="/info">Dataset</a>
                   </li>
                 </ul>
               </div>
             </div>
           </nav>
         </div>
       </header>

      <div class="container">
         <div class="row">
            <div class="py-5 mx-auto">
               <h1>Resultado de la predicción:</h1>
               <h3> {{ prediction }} </h3>
               <h5> {{ variableaparte }}</h5>
            </div>
         </div>
      </div>

      <div class="container py-5">
         <div class="row">

            <div class="rounded-top border col-sm-12">
               <div class="container">
                  <div class="row">
                     <div class="col-12 d-flex justify-content-center">
                        Datos ingresados a la predicción:
                     </div>
                  </div>
               </div>
            </div>
            
            <div class="rounded border col-md-3 col-sm-12">
               <div class="container">
                  <div class="row">
                     <div class="col-12 d-flex justify-content-center">
                        Asesinatos
                     </div>
                     <div class="col-12 d-flex justify-content-center">
                        {{valorkills}}
                     </div>
                  </div>
               </div>
            </div>

            <div class="rounded border col-md-3 col-sm-12">
               <div class="container">
                  <div class="row">
                     <div class="col-12 d-flex justify-content-center">
                        Asistencias
                     </div>
                     <div class="col-12 d-flex justify-content-center">
                        {{valorasistencias}}
                     </div>
                  </div>
               </div>
            </div>

            <div class="rounded border col-md-3 col-sm-12"> 
               <div class="container">
                  <div class="row">
                     <div class="col-12 d-flex justify-content-center">
                        Tiros a la cabeza
                     </div>
                     <div class="col-12 d-flex justify-content-center">
                        {{valorhs}}
                     </div>
                  </div>
               </div>
            </div>

            <div class="rounded border col-md-3 col-sm-12"> 
               <div class="container">
                  <div class="row">
                     <div class="col-12 d-flex justify-content-center">
                        ¿Sobrevive?
                     </div>
                     <div class="col-12 d-flex justify-content-center">
                        {{valorvive}}
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
      
      <div class="container">
         <div class="accordion" id="accordionFlushExample">
            <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingOne">
               <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                  ¿Que significa este resultado y cómo se obtuvo?
               </button>
            </h2>
            <div id="flush-collapseOne" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
               <div class="accordion-body">
                  <div class="container">
                     <div class="row">
                        <div class="col-12 py-2">
                           <p>
                              Este resultado significa que, utilizando la información entregada por teclado del usuario en el formulario anterior, con los datos correspondientes a {{valorkills}} asesinatos, {{valorasistencias}} asistencias, {{valorhs}} tiros a la cabeza y finalmente que el jugador {{valorvive}} sobrevive
                              da como resultado final que el jugador {{prediction}} la partida.
                           </p>
                        </div>
                        <div class="col-12 py-2">
                           <p>
                              AdaBoost, corto de Adaptive Boosting, es un algoritmo de clasificación estadística formulado por Yoav Freund y Robert Scapire en 1995, este modelo tiene la caracteristica de ser adaptativo, es decir, en el sentido que los resultados que resultan fallar son reingresados y modificados
                              a favor de la instancia erróneamente clasificado por el clasificador anterior, el cual se adapta en su mayoría a nuestro caso, debido a la poca capacidad de predicción que poseemos en un juego como CSGO y que estará mejorando los errores que se obtienen como resultado.
                           </p>
                        </div>
                        <div class="col-12 py-2">

                           <div class="container">
                              <div class="row pt-3">
                                 <h5>Primer paso es importar librerías de Python:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    from sklearn.model_selection import train_test_split <br>
                                    from sklearn.ensemble import AdaBoostClassifier <br>
                                    <br>
                                    import pickle <br>
                                    <br>
                                    import numpy as np # for data manipulation <br>
                                    import pandas as pd # for data manipulation <br>
                                    from sklearn.model_selection import train_test_split # will be used for data split <br>
                                 </code>
                              </p>
                           </div>

                           <div class="container pt-3">
                              <div class="row pt-3">
                                 <h5>Segundo paso es leer el archivo CSV:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    #Leyendo archivo CSV mediante github raw <br>
                                    df = pd.read_csv('https://raw.githubusercontent.com/xChoki/FML-Datos-CSGO/main/datos.csv', sep=";")
                                 </code>
                              </p>
                           </div>

                           <div class="container pt-3">
                              <div class="row pt-3">
                                 <h5>Tercer paso es transformar variables True y False a valor numérido 0 y 1:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    # Transformando variable MatchWinner a valor numérico <br>
                                    df["MatchWinner"] = df["MatchWinner"].astype(int) <br>
                                    <br>
                                    # Transformando variable Survived a valor numérico <br>
                                    df["Survived"] = df["Survived"].astype(int) <br>
                                 </code>
                              </p>
                           </div>

                           <div class="container pt-3">
                              <div class="row pt-3">
                                 <h5>Cuarto paso es eliminar del DataFrame información innecesaria que no utilizaremos en este modelo:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    df = df.drop(['Unnamed: 0', 'RoundWinner', 'RoundKills','RoundAssists','RoundHeadshots','Map','Team','InternalTeamId','MatchId','RoundId', 'SteamId', 'AbnormalMatch', 'TimeAlive', 'ScaledTimeAlive', 'AvgCentroidDistance', 'TravelledDistance', 'AvgRoundVelocity', 'AvgKillDistance', 'AvgSiteDistance', 'RLethalGrenadesThrown', 'RNonLethalGrenadesThrown', 'PrimaryAssaultRifle', 'PrimarySniperRifle', 'PrimaryHeavy', 'PrimarySMG', 'PrimaryPistol', 'FirstKillTime', 'FirstKillTime', 'RoundFlankKills', 'RoundStartingEquipmentValue', 'TeamStartingEquipmentValue', 'MatchFlankKills', 'AvgMatchKillDist'], axis = 1) <br>
                                 </code>
                              </p>
                           </div>

                           <div class="container pt-3">
                              <div class="row pt-3">
                                 <h5>Quinto paso es preparar valores de prueba y entrenamiento:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    y = df['MatchWinner'] <br>
                                    X = df.drop('MatchWinner', axis = 1) <br>
                                    <br>
                                    Xtrain, Xtest, Ytrain, Ytest = train_test_split(X, y, test_size=0.2, stratify=y)
                                 </code>
                              </p>
                           </div>

                           <div class="container pt-3">
                              <div class="row pt-3">
                                 <h5>Sexto paso es generar el clasificador AdaBoost con los parámetros:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    clf = AdaBoostClassifier(n_estimators=5000) <br>
                                    #Este es la prueba para obtener el score de nuestro modelo <br>
                                    print(clf.fit(Xtrain.values, Ytrain.values).score(Xtest.values, Ytest.values))
                                 </code>
                              </p>
                           </div>

                           <div class="container pt-3">
                              <div class="row pt-3">
                                 <h5>Séptimo paso es generar el archivo del modelo para realizar la integración:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    filename = 'checkpoints/model.pkl' <br>
                                    pickle.dump(clf, open(filename, 'wb'))
                                 </code>
                              </p>
                           </div>

                           <div class="container pt-3">
                              <div class="row pt-3">
                                 <h5>Octavo paso es cargar el modelo abriendo el archivo generado por Pickle:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    loaded_model = pickle.load(open(filename, 'rb')) <br>
                                    result = loaded_model.score(Xtest.values, Ytest.values)
                                 </code>
                              </p>
                           </div>

                           <div class="container pt-3">
                              <div class="row pt-3">
                                 <h5>Noveno paso es imprimir por pantalla el resultado:</h5>
                              </div>
                           </div>
                           <div class="container border rounded bg-dark text-white">
                              <p class="p-3 mb-2">
                                 <code>
                                    print(result) <br>
                                    #Como paso extra podemos hacer una predicción de prueba para corroborar que todo funciona <br>
                                    print(loaded_model.predict([[2, 2, 2, 1]]))
                                 </code>
                              </p>
                           </div>

                        </div>
                        <div class="col-12 pt-3">
                           <p>
                              Para más infomación de cómo funciona detrás el algoritmo a nivel matemático ver: <a href="https://en.wikipedia.org/wiki/AdaBoost" class="text-decoration-none">AdaBoost (Wikipedia, Inglés)</a>
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            </div>
         </div>
      </div>

      <!--Inicia FOOTER-->
      <footer class="page-footer">
         <div class="container">
           <div class="row">
       
             <!-- Grid column -->
             <div class="col-md-12 py-5">
               <div class="d-flex justify-content-center mb-5">
       
                 <!-- GitHub -->
                 <a href="https://github.com/xChoki/IntegracionJPN" target="_blank">
                   <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
                     <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                   </svg>
                 </a>
 
               </div>
               <div class="footer-copyright text-center py-2">© 2022 Copyright:
                 <div class="row">
                   <a class="col-md-4 col-sm-12" href="">Carlos Muñoz</a>
                   <a class="col-md-4 col-sm-12" href="">Javier Quinteros</a>
                   <a class="col-md-4 col-sm-12" href="">Marcelo Rendón</a>
                 </div>
               </div>
             </div>
             <!-- Grid column -->
           </div>
         </div>
         <!-- Footer Elements -->
       </footer>
       <!-- Footer -->
   </body>

</html>